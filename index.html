<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resold go-gets - Market Analysis Dashboard</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        h1 {
            font-size: 3em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .subtitle {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .controls {
            padding: 30px 40px;
            background: #f8f9fa;
            border-bottom: 2px solid #e9ecef;
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            align-items: center;
        }

        .control-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        label {
            font-weight: 600;
            color: #495057;
            font-size: 0.9em;
        }

        select, button {
            padding: 12px 20px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            font-size: 1em;
            transition: all 0.3s;
        }

        select {
            background: white;
            cursor: pointer;
            min-width: 200px;
        }

        select:hover {
            border-color: #667eea;
        }

        select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            cursor: pointer;
            font-weight: 600;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        button:active {
            transform: translateY(0);
        }

        .export-buttons {
            display: flex;
            gap: 10px;
            margin-left: auto;
        }

        .content {
            padding: 40px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .stat-label {
            font-size: 0.9em;
            opacity: 0.9;
            margin-bottom: 8px;
        }

        .stat-value {
            font-size: 2.5em;
            font-weight: bold;
        }

        .section {
            margin-bottom: 40px;
        }

        h2 {
            color: #667eea;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
            font-size: 2em;
        }

        .table-wrapper {
            overflow-x: auto;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
        }

        thead {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        th {
            padding: 15px;
            text-align: left;
            font-weight: 600;
            font-size: 0.95em;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        td {
            padding: 15px;
            border-bottom: 1px solid #e9ecef;
        }

        tbody tr {
            transition: background 0.2s;
        }

        tbody tr:hover {
            background: #f8f9fa;
        }

        tbody tr:nth-child(even) {
            background: #fafbfc;
        }

        tbody tr:nth-child(even):hover {
            background: #f1f3f5;
        }

        .rank-badge {
            display: inline-block;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 4px 10px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.85em;
        }

        .market-share {
            font-weight: 600;
            color: #667eea;
        }

        .no-data {
            text-align: center;
            padding: 60px;
            color: #6c757d;
            font-size: 1.2em;
        }

        footer {
            background: #f8f9fa;
            padding: 30px;
            text-align: center;
            color: #6c757d;
            border-top: 2px solid #e9ecef;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 2em;
            }

            .controls {
                flex-direction: column;
                align-items: stretch;
            }

            .export-buttons {
                margin-left: 0;
                flex-direction: column;
            }

            select, button {
                width: 100%;
            }

            th, td {
                padding: 10px;
                font-size: 0.9em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üõí Resold go-gets</h1>
            <p class="subtitle">eBay Certified Refurbished Market Analysis Dashboard</p>
        </header>

        <div style="padding: 20px 40px; background: #fff3cd; border-bottom: 2px solid #ffc107; color: #856404;">
            <p style="margin: 0; font-size: 0.95em; line-height: 1.6;">
                üìä <strong>Data Collection:</strong> Data was pulled by scraping eBay Certified Refurbished categories with Code-Puppy. 
                Analysis is based on first 20 pages of listings (if applicable). Rankings are sorted by SKU count (highest to lowest).
            </p>
        </div>

        <div class="controls">
            <div class="control-group">
                <label for="categoryFilter">Select Category:</label>
                <select id="categoryFilter">
                    <option value="all">All Categories</option>
                    <option value="3d_printers">3D Printers</option>
                    <option value="air_conditioners">Air Conditioners</option>
                    <option value="generators">Generators</option>
                    <option value="golf">Golf Equipment</option>
                    <option value="outdoor_power">Outdoor Power</option>
                    <option value="tools">Tools</option>
                    <option value="vehicle_electronics">Vehicle Electronics</option>
                </select>
            </div>

            <div class="export-buttons">
                <button onclick="exportToExcel('sellers')">üìä Export Sellers to Excel</button>
                <button onclick="exportToExcel('brands')">üìà Export Brands to Excel</button>
                <button onclick="exportToExcel('all')">üì¶ Export All Data</button>
            </div>
        </div>

        <div class="content">
            <div class="stats-grid" id="statsGrid"></div>
            
            <div class="section">
                <h2>üè™ Seller Distribution</h2>
                <div class="table-wrapper">
                    <table id="sellersTable">
                        <thead>
                            <tr>
                                <th>Rank</th>
                                <th>Category</th>
                                <th>Seller Username</th>
                                <th>SKUs</th>
                                <th>Feedback Rating</th>
                                <th>Feedback Count</th>
                                <th>Primary Brands</th>
                            </tr>
                        </thead>
                        <tbody id="sellersTableBody"></tbody>
                    </table>
                </div>
            </div>

            <div class="section">
                <h2>üéØ Brand Distribution</h2>
                <div class="table-wrapper">
                    <table id="brandsTable">
                        <thead>
                            <tr>
                                <th>Rank</th>
                                <th>Category</th>
                                <th>Brand Name</th>
                                <th>SKUs</th>
                                <th>Product Category</th>
                                <th>Seller Model</th>
                            </tr>
                        </thead>
                        <tbody id="brandsTableBody"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <footer>
            <p>Generated on January 9, 2026 | Data Source: eBay Certified Refurbished</p>
            <p>Dashboard created with ‚ù§Ô∏è for market analysis</p>
        </footer>
    </div>

    <script>
        // Data structure for all categories
        const marketData = {
            '3d_printers': {
                name: '3D Printers',
                totalSKUs: 17,
                sellers: [
                    { rank: 1, seller: 'anycubic_outlet_us', skus: 12, share: '70.6%', rating: '97.0%', feedbackCount: '~5,000', brands: 'ANYCUBIC (exclusive)' },
                    { rank: 2, seller: 'creality_refurbished', skus: 4, share: '23.5%', rating: '95.4%', feedbackCount: '~6,300', brands: 'Creality (primary)' },
                    { rank: 3, seller: '3d-printer-online', skus: 1, share: '5.9%', rating: '98.5%', feedbackCount: '~5,500', brands: 'Creality (secondary)' }
                ],
                brands: [
                    { rank: 1, brand: 'ANYCUBIC', skus: 12, share: '70.6%', category: 'FDM + Resin', model: 'Exclusive (anycubic_outlet_us)' },
                    { rank: 2, brand: 'Creality', skus: 5, share: '29.4%', category: 'FDM + Resin', model: 'Multi-seller (2 sources)' }
                ]
            },
            'air_conditioners': {
                name: 'Air Conditioners',
                totalSKUs: 92,
                sellers: [
                    { rank: 1, seller: 'hypermicrosystems', skus: 10, share: '34.5%', rating: '99.4%', feedbackCount: 'High Volume', brands: 'Hisense' },
                    { rank: 2, seller: 'planet73outlet', skus: 10, share: '34.5%', rating: '99.0%', feedbackCount: '16,100', brands: 'Hisense' },
                    { rank: 3, seller: 'fogatti_rv_appliances_store', skus: 3, share: '10.3%', rating: '99.4%', feedbackCount: 'Medium', brands: 'FOGATTI' },
                    { rank: 4, seller: 'ecoflowdirect', skus: 3, share: '10.3%', rating: '99.8%', feedbackCount: 'High', brands: 'EcoFlow' },
                    { rank: 5, seller: 'doodahdeals', skus: 2, share: '6.9%', rating: '99%+', feedbackCount: 'Medium', brands: 'GE' },
                    { rank: 6, seller: 'hs-relink', skus: 1, share: '3.4%', rating: '100.0%', feedbackCount: '13', brands: 'Hisense' }
                ],
                brands: [
                    { rank: 1, brand: 'Hisense', skus: 21, share: '72.4%', category: 'Portable & Window AC', model: 'Multi-seller (3 sellers)' },
                    { rank: 2, brand: 'EcoFlow', skus: 3, share: '10.3%', category: 'Portable AC (Premium)', model: 'Exclusive (ecoflowdirect)' },
                    { rank: 3, brand: 'FOGATTI', skus: 3, share: '10.3%', category: 'RV AC (Specialty)', model: 'Exclusive (fogatti_rv_appliances_store)' },
                    { rank: 4, brand: 'GE', skus: 2, share: '6.9%', category: 'Window AC', model: 'Exclusive (doodahdeals)' }
                ]
            },
            'generators': {
                name: 'Generators',
                totalSKUs: 201,
                sellers: [
                    { rank: 1, seller: 'ecoflowdirect', skus: '85+', share: '~42%', rating: '99.8%', feedbackCount: '26,600', brands: 'EcoFlow (exclusive)' },
                    { rank: 2, seller: 'firmanpowerequipment', skus: '40+', share: '~20%', rating: '99.1%', feedbackCount: '4,900', brands: 'FIRMAN (exclusive)' },
                    { rank: 3, seller: 'generachq', skus: '15+', share: '~7%', rating: '85.7%', feedbackCount: '3,000', brands: 'Generac (exclusive)' },
                    { rank: 4, seller: 'acmetools', skus: '10+', share: '~5%', rating: 'N/A', feedbackCount: 'N/A', brands: 'Ego Power+, Multi-brand' },
                    { rank: 5, seller: 'oupes-us-outlet', skus: '8+', share: '~4%', rating: 'N/A', feedbackCount: 'N/A', brands: 'OUPES (exclusive)' },
                    { rank: 6, seller: 'Various sellers', skus: '43+', share: '~22%', rating: 'Varies', feedbackCount: 'Varies', brands: 'BLUETTI, Anker, Westinghouse, DuroMax, VTOMAN' }
                ],
                brands: [
                    { rank: 1, brand: 'EcoFlow', skus: '85+', share: '~42%', category: 'Portable Power Stations', model: 'Exclusive (ecoflowdirect)' },
                    { rank: 2, brand: 'FIRMAN', skus: '40+', share: '~20%', category: 'Inverter & Portable Generators', model: 'Exclusive (firmanpowerequipment)' },
                    { rank: 3, brand: 'BLUETTI', skus: '20+', share: '~10%', category: 'Portable Power Stations', model: 'Multi-seller' },
                    { rank: 4, brand: 'Generac', skus: '15+', share: '~7%', category: 'Portable Generators', model: 'Exclusive (generachq)' },
                    { rank: 5, brand: 'Ego Power+', skus: '10+', share: '~5%', category: 'Battery Power Stations', model: 'Multi-seller (primarily acmetools)' },
                    { rank: 6, brand: 'OUPES', skus: '8+', share: '~4%', category: 'Portable Power Stations', model: 'Exclusive (oupes-us-outlet)' },
                    { rank: 7, brand: 'Anker SOLIX', skus: '6+', share: '~3%', category: 'Portable Power Stations', model: 'Multi-seller' },
                    { rank: 8, brand: 'Westinghouse', skus: '5+', share: '~2.5%', category: 'Portable Power Stations', model: 'Multi-seller' },
                    { rank: 9, brand: 'DuroMax', skus: '5+', share: '~2.5%', category: 'Portable Generators', model: 'Multi-seller' },
                    { rank: 10, brand: 'VTOMAN', skus: '4+', share: '~2%', category: 'Portable Power Stations', model: 'Multi-seller' }
                ]
            },
            'golf': {
                name: 'Golf Equipment',
                totalSKUs: 376,
                sellers: [
                    { rank: 1, seller: 'golf-direct-now', skus: 118, share: '31.4%', rating: '99.7%', feedbackCount: 'High Volume', brands: 'Multi-brand' },
                    { rank: 2, seller: '2ndswing-golf', skus: 102, share: '27.1%', rating: '99.8%', feedbackCount: 'High Volume', brands: 'Multi-brand' },
                    { rank: 3, seller: 'callaway-preowned', skus: 62, share: '16.5%', rating: '99.9%', feedbackCount: 'High Volume', brands: 'Callaway' },
                    { rank: 4, seller: 'golf-avenue-usa', skus: 38, share: '10.1%', rating: '99.6%', feedbackCount: 'Medium', brands: 'Multi-brand' },
                    { rank: 5, seller: 'titleist-preowned', skus: 28, share: '7.4%', rating: '99.8%', feedbackCount: 'Medium', brands: 'Titleist' },
                    { rank: 6, seller: 'global-golf', skus: 16, share: '4.3%', rating: '99.5%', feedbackCount: 'Medium', brands: 'Multi-brand' },
                    { rank: 7, seller: 'lostgolfballs', skus: 12, share: '3.2%', rating: '99.4%', feedbackCount: 'Medium', brands: 'Golf Balls' }
                ],
                brands: [
                    { rank: 1, brand: 'TaylorMade', skus: 98, share: '26.1%', category: 'Clubs, Drivers, Irons', model: '70% via golf-direct-now' },
                    { rank: 2, brand: 'Titleist', skus: 68, share: '18.1%', category: 'Clubs, Balls', model: '65% via 2ndswing-golf, 30% via titleist-preowned' },
                    { rank: 3, brand: 'Callaway', skus: 62, share: '16.5%', category: 'Clubs, Drivers', model: '100% via callaway-preowned (exclusive)' },
                    { rank: 4, brand: 'Ping', skus: 52, share: '13.8%', category: 'Clubs, Irons', model: '85% via 2ndswing-golf' },
                    { rank: 5, brand: 'Cobra', skus: 28, share: '7.4%', category: 'Clubs', model: '90% via golf-avenue-usa' },
                    { rank: 6, brand: 'Mizuno', skus: 18, share: '4.8%', category: 'Clubs, Irons', model: 'Multi-seller' },
                    { rank: 7, brand: 'Scotty Cameron', skus: 10, share: '2.7%', category: 'Putters', model: 'Multi-seller' },
                    { rank: 8, brand: 'Odyssey', skus: 12, share: '3.2%', category: 'Putters', model: 'Multi-seller' },
                    { rank: 9, brand: 'Cleveland', skus: 14, share: '3.7%', category: 'Wedges', model: 'Multi-seller' },
                    { rank: 10, brand: 'Srixon', skus: 8, share: '2.1%', category: 'Clubs, Balls', model: 'Multi-seller' }
                ]
            },
            'outdoor_power': {
                name: 'Outdoor Power',
                totalSKUs: 111,
                sellers: [
                    { rank: 1, seller: 'ecoflowdirect', skus: 28, share: '25.2%', rating: '99.8%', feedbackCount: '26,600', brands: 'EcoFlow' },
                    { rank: 2, seller: 'acmetools', skus: 23, share: '20.7%', rating: '99.6%', feedbackCount: '108,100', brands: 'EGO, Milwaukee' },
                    { rank: 3, seller: 'sjm_recommerce', skus: 17, share: '15.3%', rating: '97.2%', feedbackCount: '10,800', brands: 'Sun Joe, Snow Joe, Troy-Bilt' },
                    { rank: 4, seller: 'firmanpowerequipment', skus: 13, share: '11.7%', rating: '99.1%', feedbackCount: '4,900', brands: 'FIRMAN' },
                    { rank: 5, seller: 'oupes-us-outlet', skus: 10, share: '9.0%', rating: '99.2%', feedbackCount: '1,000', brands: 'OUPES' },
                    { rank: 6, seller: 'duromax_power', skus: 10, share: '9.0%', rating: '100.0%', feedbackCount: '36', brands: 'DuroMax' },
                    { rank: 7, seller: 'vtoman-shop', skus: 8, share: '7.2%', rating: '98.4%', feedbackCount: '4,200', brands: 'VTOMAN' },
                    { rank: 8, seller: 'worxtools', skus: 6, share: '5.4%', rating: '99.6%', feedbackCount: '325,100', brands: 'WORX' },
                    { rank: 9, seller: 'greenworkstools', skus: 5, share: '4.5%', rating: '99.1%', feedbackCount: '7,100', brands: 'Greenworks' },
                    { rank: 10, seller: 'cutlers_inc', skus: 5, share: '4.5%', rating: '99.6%', feedbackCount: '19,100', brands: 'EGO' }
                ],
                brands: [
                    { rank: 1, brand: 'EcoFlow', skus: 28, share: '25.2%', category: 'Power Stations', model: 'Exclusive (ecoflowdirect)' },
                    { rank: 2, brand: 'EGO', skus: 23, share: '20.7%', category: 'Battery Lawn Tools', model: 'Multi-seller (acmetools, cutlers_inc)' },
                    { rank: 3, brand: 'Sun Joe', skus: 15, share: '13.5%', category: 'Electric Tools', model: 'Exclusive (sjm_recommerce)' },
                    { rank: 4, brand: 'FIRMAN', skus: 13, share: '11.7%', category: 'Generators', model: 'Exclusive (firmanpowerequipment)' },
                    { rank: 5, brand: 'DuroMax', skus: 10, share: '9.0%', category: 'Generators', model: 'Exclusive (duromax_power)' },
                    { rank: 6, brand: 'OUPES', skus: 10, share: '9.0%', category: 'Power Stations', model: 'Exclusive (oupes-us-outlet)' },
                    { rank: 7, brand: 'VTOMAN', skus: 8, share: '7.2%', category: 'Power Stations', model: 'Exclusive (vtoman-shop)' },
                    { rank: 8, brand: 'WORX', skus: 6, share: '5.4%', category: 'Electric Tools', model: 'Exclusive (worxtools)' },
                    { rank: 9, brand: 'Greenworks', skus: 5, share: '4.5%', category: 'Battery Lawn Tools', model: 'Exclusive (greenworkstools)' },
                    { rank: 10, brand: 'Milwaukee', skus: 4, share: '3.6%', category: 'Pro Power Tools', model: 'Exclusive (acmetools)' }
                ]
            },
            'tools': {
                name: 'Tools',
                totalSKUs: 106,
                sellers: [
                    { rank: 1, seller: 'cpo-outlets', skus: 58, share: '54.7%', rating: '99.5%', feedbackCount: '663,300', brands: 'Makita, DeWalt, Bosch, Milwaukee' },
                    { rank: 2, seller: 'acmetools', skus: 21, share: '19.8%', rating: '99.6%', feedbackCount: '168,700', brands: 'Bosch, Milwaukee, Craftsman' },
                    { rank: 3, seller: 'factory_authorized_outlet', skus: 11, share: '10.4%', rating: '99.8%', feedbackCount: '259,500', brands: 'Milwaukee (exclusive)' },
                    { rank: 4, seller: 'worxtools', skus: 9, share: '8.5%', rating: '99.6%', feedbackCount: 'Not available', brands: 'WORX (exclusive)' },
                    { rank: 5, seller: 'true-position-tools', skus: 3, share: '2.8%', rating: '100.0%', feedbackCount: 'Not available', brands: 'True Position (exclusive)' },
                    { rank: 6, seller: 'toolup', skus: 2, share: '1.9%', rating: '99.6%', feedbackCount: '168,700', brands: 'Makita, DeWalt' },
                    { rank: 7, seller: 'Other sellers', skus: 2, share: '1.9%', rating: 'Various', feedbackCount: 'Various', brands: 'Various' }
                ],
                brands: [
                    { rank: 1, brand: 'DeWalt', skus: 27, share: '25.5%', category: 'Power Tools', model: 'Multi-seller (cpo-outlets, acmetools, toolup)' },
                    { rank: 2, brand: 'Makita', skus: 21, share: '19.8%', category: 'Power Tools', model: 'Multi-seller (cpo-outlets, toolup)' },
                    { rank: 3, brand: 'Milwaukee', skus: 19, share: '17.9%', category: 'Power Tools', model: 'Multi-seller (factory_authorized_outlet, cpo-outlets, acmetools)' },
                    { rank: 4, brand: 'Bosch', skus: 16, share: '15.1%', category: 'Power Tools', model: 'Multi-seller (cpo-outlets, acmetools)' },
                    { rank: 5, brand: 'WORX', skus: 9, share: '8.5%', category: 'Power Tools', model: 'Exclusive (worxtools)' },
                    { rank: 6, brand: 'Craftsman', skus: 3, share: '2.8%', category: 'Power Tools', model: 'Multi-seller (cpo-outlets, acmetools)' },
                    { rank: 7, brand: 'True Position Tools', skus: 3, share: '2.8%', category: 'Specialty Tools', model: 'Exclusive (true-position-tools)' },
                    { rank: 8, brand: 'Dremel', skus: 2, share: '1.9%', category: 'Rotary Tools', model: 'Multi-seller (cpo-outlets)' },
                    { rank: 9, brand: 'EGO', skus: 2, share: '1.9%', category: 'Outdoor Power', model: 'Multi-seller (various)' },
                    { rank: 10, brand: 'Laguna Tools', skus: 2, share: '1.9%', category: 'Woodworking', model: 'Multi-seller (various)' }
                ]
            },
            'vehicle_electronics': {
                name: 'Vehicle Electronics',
                totalSKUs: 864,
                sellers: [
                    { rank: 1, seller: 'ds18sound', skus: '377+', share: '43.6%+', rating: '99%+', feedbackCount: 'High Volume', brands: 'DS18' },
                    { rank: 2, seller: 'redtiger_store', skus: '150+', share: '17.4%+', rating: '99%+', feedbackCount: 'High Volume', brands: 'REDTIGER' },
                    { rank: 3, seller: 'electronic_express', skus: '50+', share: '5.8%+', rating: '99%+', feedbackCount: 'High Volume', brands: 'JBL, Kenwood' },
                    { rank: 4, seller: 'stereo-needs', skus: '40+', share: '4.6%+', rating: '99%+', feedbackCount: 'Medium', brands: 'DS18, Multi-brand' },
                    { rank: 5, seller: 'drivelnautosound', skus: '30+', share: '3.5%+', rating: '99%+', feedbackCount: 'Medium', brands: 'Kenwood, Pioneer' },
                    { rank: 6, seller: 'soundoftristate', skus: '20+', share: '2.3%+', rating: '99%+', feedbackCount: 'Medium', brands: 'Jensen, Multi-brand' },
                    { rank: 7, seller: 'various_sellers', skus: '197+', share: '22.8%+', rating: '99%+', feedbackCount: 'Varies', brands: 'KICKER, Rockford Fosgate, Others' }
                ],
                brands: [
                    { rank: 1, brand: 'KICKER', skus: 458, share: '53.0%', category: 'Car Audio (Speakers, Subs, Amps)', model: 'Multi-seller' },
                    { rank: 2, brand: 'DS18', skus: 377, share: '43.6%', category: 'Car Audio (Stereos, Amps, Speakers)', model: 'Exclusive (ds18sound)' },
                    { rank: 3, brand: 'Power Acoustik', skus: 52, share: '6.0%', category: 'Car Stereos & Audio', model: 'Multi-seller' },
                    { rank: 4, brand: 'JBL', skus: 37, share: '4.3%', category: 'Car Speakers & Audio', model: 'Multi-seller' },
                    { rank: 5, brand: 'Rockford Fosgate', skus: 30, share: '3.5%', category: 'Car Audio (Amps, Speakers)', model: 'Multi-seller' },
                    { rank: 6, brand: 'Kenwood', skus: 25, share: '2.9%', category: 'Car Stereos', model: 'Multi-seller' },
                    { rank: 7, brand: 'Pioneer', skus: 23, share: '2.7%', category: 'Car Stereos & Audio', model: 'Multi-seller' },
                    { rank: 8, brand: 'REDTIGER', skus: '150+', share: '17.4%+', category: 'Dash Cams', model: 'Exclusive (redtiger_store)' },
                    { rank: 9, brand: 'Jensen', skus: '20+', share: '2.3%+', category: 'Car Stereos', model: 'Multi-seller' },
                    { rank: 10, brand: 'JL Audio', skus: 1, share: '0.1%', category: 'Car Audio', model: 'Multi-seller' }
                ]
            }
        };

        // Initialize dashboard
        let currentFilter = 'all';

        function updateDashboard() {
            updateStats();
            updateTables();
        }

        function updateStats() {
            const statsGrid = document.getElementById('statsGrid');
            statsGrid.innerHTML = '';

            if (currentFilter === 'all') {
                const totalSKUs = Object.values(marketData).reduce((sum, cat) => sum + cat.totalSKUs, 0);
                const totalCategories = Object.keys(marketData).length;
                const totalSellers = new Set();
                const totalBrands = new Set();

                Object.values(marketData).forEach(category => {
                    category.sellers.forEach(s => totalSellers.add(s.seller));
                    category.brands.forEach(b => totalBrands.add(b.brand));
                });

                statsGrid.innerHTML = `
                    <div class="stat-card">
                        <div class="stat-label">Total Categories</div>
                        <div class="stat-value">${totalCategories}</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Total SKUs</div>
                        <div class="stat-value">${totalSKUs.toLocaleString()}</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Unique Sellers</div>
                        <div class="stat-value">${totalSellers.size}</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Unique Brands</div>
                        <div class="stat-value">${totalBrands.size}</div>
                    </div>
                `;
            } else {
                const category = marketData[currentFilter];
                statsGrid.innerHTML = `
                    <div class="stat-card">
                        <div class="stat-label">Category</div>
                        <div class="stat-value" style="font-size: 1.8em;">${category.name}</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Total SKUs</div>
                        <div class="stat-value">${category.totalSKUs.toLocaleString()}</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Sellers</div>
                        <div class="stat-value">${category.sellers.length}</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Brands</div>
                        <div class="stat-value">${category.brands.length}</div>
                    </div>
                `;
            }
        }

        function updateTables() {
            const sellersBody = document.getElementById('sellersTableBody');
            const brandsBody = document.getElementById('brandsTableBody');

            sellersBody.innerHTML = '';
            brandsBody.innerHTML = '';

            const categories = currentFilter === 'all' 
                ? Object.keys(marketData) 
                : [currentFilter];

            // Collect all sellers and sort by SKU count
            const allSellers = [];
            categories.forEach(catKey => {
                const category = marketData[catKey];
                category.sellers.forEach(seller => {
                    allSellers.push({
                        ...seller,
                        categoryName: category.name
                    });
                });
            });

            // Sort by SKU count (convert to number, handle '85+' format)
            allSellers.sort((a, b) => {
                const aSkus = typeof a.skus === 'string' ? parseInt(a.skus.replace(/[^0-9]/g, '')) : a.skus;
                const bSkus = typeof b.skus === 'string' ? parseInt(b.skus.replace(/[^0-9]/g, '')) : b.skus;
                return bSkus - aSkus;
            });

            // Populate sellers table with rank based on SKU count
            allSellers.forEach((seller, index) => {
                // Check if this is a real seller (not "Various sellers" or similar placeholder)
                const isRealSeller = !seller.seller.toLowerCase().includes('various');
                const ebayUrl = `https://www.ebay.com/usr/${encodeURIComponent(seller.seller)}`;
                
                const sellerNameHtml = isRealSeller 
                    ? `<a href="${ebayUrl}" target="_blank" style="color: #667eea; text-decoration: none; border-bottom: 1px dotted #667eea;" title="View ${seller.seller}'s eBay storefront">${seller.seller}</a>`
                    : seller.seller;
                
                const row = `
                    <tr>
                        <td><span class="rank-badge">#${index + 1}</span></td>
                        <td>${seller.categoryName}</td>
                        <td><strong>${sellerNameHtml}</strong></td>
                        <td>${seller.skus}</td>
                        <td>${seller.rating}</td>
                        <td>${seller.feedbackCount}</td>
                        <td>${seller.brands}</td>
                    </tr>
                `;
                sellersBody.innerHTML += row;
            });

            // Collect all brands and sort by SKU count
            const allBrands = [];
            categories.forEach(catKey => {
                const category = marketData[catKey];
                category.brands.forEach(brand => {
                    allBrands.push({
                        ...brand,
                        categoryName: category.name
                    });
                });
            });

            // Sort by SKU count
            allBrands.sort((a, b) => {
                const aSkus = typeof a.skus === 'string' ? parseInt(a.skus.replace(/[^0-9]/g, '')) : a.skus;
                const bSkus = typeof b.skus === 'string' ? parseInt(b.skus.replace(/[^0-9]/g, '')) : b.skus;
                return bSkus - aSkus;
            });

            // Populate brands table with rank based on SKU count
            allBrands.forEach((brand, index) => {
                const row = `
                    <tr>
                        <td><span class="rank-badge">#${index + 1}</span></td>
                        <td>${brand.categoryName}</td>
                        <td><strong>${brand.brand}</strong></td>
                        <td>${brand.skus}</td>
                        <td>${brand.category}</td>
                        <td>${brand.model}</td>
                    </tr>
                `;
                brandsBody.innerHTML += row;
            });

            if (sellersBody.innerHTML === '') {
                sellersBody.innerHTML = '<tr><td colspan="7" class="no-data">No data available</td></tr>';
            }
            if (brandsBody.innerHTML === '') {
                brandsBody.innerHTML = '<tr><td colspan="6" class="no-data">No data available</td></tr>';
            }
        }

        function exportToExcel(type) {
            const categories = currentFilter === 'all' 
                ? Object.keys(marketData) 
                : [currentFilter];

            const wb = XLSX.utils.book_new();

            if (type === 'sellers' || type === 'all') {
                const sellersData = [];
                sellersData.push(['Rank', 'Category', 'Seller Username', 'eBay Storefront URL', 'SKUs', 'Feedback Rating', 'Feedback Count', 'Primary Brands']);

                // Collect and sort sellers by SKU count
                const allSellers = [];
                categories.forEach(catKey => {
                    const category = marketData[catKey];
                    category.sellers.forEach(seller => {
                        allSellers.push({
                            ...seller,
                            categoryName: category.name
                        });
                    });
                });

                allSellers.sort((a, b) => {
                    const aSkus = typeof a.skus === 'string' ? parseInt(a.skus.replace(/[^0-9]/g, '')) : a.skus;
                    const bSkus = typeof b.skus === 'string' ? parseInt(b.skus.replace(/[^0-9]/g, '')) : b.skus;
                    return bSkus - aSkus;
                });

                allSellers.forEach((seller, index) => {
                    const isRealSeller = !seller.seller.toLowerCase().includes('various');
                    const ebayUrl = isRealSeller ? `https://www.ebay.com/usr/${encodeURIComponent(seller.seller)}` : 'N/A';
                    sellersData.push([
                        index + 1,
                        seller.categoryName,
                        seller.seller,
                        ebayUrl,
                        seller.skus,
                        seller.rating,
                        seller.feedbackCount,
                        seller.brands
                    ]);
                });

                const ws1 = XLSX.utils.aoa_to_sheet(sellersData);
                XLSX.utils.book_append_sheet(wb, ws1, 'Sellers');
            }

            if (type === 'brands' || type === 'all') {
                const brandsData = [];
                brandsData.push(['Rank', 'Category', 'Brand Name', 'SKUs', 'Product Category', 'Seller Model']);

                // Collect and sort brands by SKU count
                const allBrands = [];
                categories.forEach(catKey => {
                    const category = marketData[catKey];
                    category.brands.forEach(brand => {
                        allBrands.push({
                            ...brand,
                            categoryName: category.name
                        });
                    });
                });

                allBrands.sort((a, b) => {
                    const aSkus = typeof a.skus === 'string' ? parseInt(a.skus.replace(/[^0-9]/g, '')) : a.skus;
                    const bSkus = typeof b.skus === 'string' ? parseInt(b.skus.replace(/[^0-9]/g, '')) : b.skus;
                    return bSkus - aSkus;
                });

                allBrands.forEach((brand, index) => {
                    brandsData.push([
                        index + 1,
                        brand.categoryName,
                        brand.brand,
                        brand.skus,
                        brand.category,
                        brand.model
                    ]);
                });

                const ws2 = XLSX.utils.aoa_to_sheet(brandsData);
                XLSX.utils.book_append_sheet(wb, ws2, 'Brands');
            }

            const filterText = currentFilter === 'all' ? 'All_Categories' : marketData[currentFilter].name.replace(/\s+/g, '_');
            const typeText = type === 'all' ? 'Complete_Data' : type.charAt(0).toUpperCase() + type.slice(1);
            const filename = `Resold_Go_Gets_${typeText}_${filterText}_${new Date().toISOString().split('T')[0]}.xlsx`;

            XLSX.writeFile(wb, filename);
        }

        // Event listeners
        document.getElementById('categoryFilter').addEventListener('change', (e) => {
            currentFilter = e.target.value;
            updateDashboard();
        });

        // Initialize on load
        updateDashboard();
    </script>
</body>
</html>